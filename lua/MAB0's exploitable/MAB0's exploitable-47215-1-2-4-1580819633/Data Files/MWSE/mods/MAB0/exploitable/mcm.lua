local this = {
  id = "MAB0_exploitable",
  name = "MetaBarj0's exploitable",
  config = {
    enableAlchemyFix = true,
    enableMercantileFix = true,
    enableEnchantFix = true,
    enableDispositionFix = true
  },
}

local function loadConfig()
  this.config = mwse.loadConfig( this.id ) or this.config
end

local function registerMcm()
  local localeStrings = require( "MAB0.exploitable.localeStrings" )
  local locale = require( "MAB0.locale" ).new( localeStrings )

  local template = mwse.mcm.createTemplate( this.name )

  template:saveOnClose( this.id, this.config )

  local page = template:createPage()

  page:createOnOffButton( {
    label = locale.getLocalizedString( "mcm.alchemyExploitFixButtonLabel" ),
    variable = mwse.mcm.createTableVariable( {
      id = "enableAlchemyFix",
      table = this.config
    } )
  } )

  page:createOnOffButton( {
    label = locale.getLocalizedString( "mcm.mercantileExploitFixButtonLabel" ),
    variable = mwse.mcm.createTableVariable( {
      id = "enableMercantileFix",
      table = this.config
    } )
  } )

  page:createOnOffButton( {
    label = locale.getLocalizedString( "mcm.enchantExploitFixButtonLabel" ),
    variable = mwse.mcm.createTableVariable( {
      id = "enableEnchantFix",
      table = this.config
    } )
  } )

  page:createOnOffButton( {
    label = locale.getLocalizedString( "mcm.dispositionExploitFixButtonLabel" ),
    variable = mwse.mcm.createTableVariable( {
      id = "enableDispositionFix",
      table = this.config
    } )
  } )

  mwse.mcm.register( template )
end

local function getConfig()
  return this.config
end

return {
  new = function()
    loadConfig()
    registerMcm()

    return {
      getConfig = getConfig
    }
  end
}